import os,re

# first pass
headers = set()

for root,dirs,files in os.walk("src"):
    for f in files:
        if f.endswith(".hpp"):
            headers.add(os.path.splitext(f)[0])

def repfunc(m):
    header_name = m.group(1)
    return ('"{}.hpp"' if header_name in headers else '"{}.hpp"').format(header_name)

for root,dirs,files in os.walk("src"):
    for f in files:
        if f.endswith((".hpp",".cpp")):
            src = os.path.join(root,f)
            with open(src) as fh:
                contents = fh.read()
                new_contents = re.sub('"(\w+)\.[hH]"',repfunc,contents)
            if new_contents != contents:
                with open(src,"w") as fh:
                    fh.write(new_contents)
